---
// src/components/Typewriter.astro
interface Props {
  baseText: string;    // å‰é¢ä¸åŠ¨çš„æ–‡å­—ï¼Œä¾‹å¦‚ "I am a "
  dynamicWords: string[]; // å¾ªç¯å˜æ¢çš„å•è¯ï¼Œä¾‹å¦‚ ["Developer", "Designer", "Learner"]
  suffixText?: string;   // ğŸ‘ˆ æ–°å¢ï¼šåç¼€æ–‡å­—ï¼Œä¾‹å¦‚ " Engineer"
  speed?: number;      // æ‰“å­—é€Ÿåº¦
  deleteSpeed?: number; // åˆ é™¤é€Ÿåº¦
  delay?: number;      // å•è¯æ‰“å®Œåçš„åœç•™æ—¶é—´
}

const { 
  baseText, 
  dynamicWords, 
  suffixText = "", //é»˜è®¤ä¸ºç©º
  speed = 100, 
  deleteSpeed = 50, 
  delay = 1500 
} = Astro.props;
---

<div class="typewriter-container">
  <span class="base-text">{baseText}</span>
  <span id="dynamic-text" class="dynamic-text"></span>
  <span class="cursor">|</span>
  <span class="base-text">{suffixText}</span>
</div>

<style>
  .typewriter-container {
    display: flex;
    align-items: center;
    justify-content: center;
    /* å­—ä½“å¤§å°è®¾ç½®ï¼šè¿™é‡Œæ”¹ä¸º 3rem (çº¦ 48px)ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ */
    font-size: 3rem; 
    font-weight: 800;
    line-height: 1.2;
  }

  .base-text {
    color: #333; /* åŸºç¡€æ–‡å­—é¢œè‰² */
    white-space: pre;
  }

  .dynamic-text {
    color: #3b82f6; /* åŠ¨æ€å•è¯é¢œè‰² (è“è‰²) */
    white-space: pre;
  }

.cursor {
  color: #a855f7;
  text-shadow: 0 0 8px rgba(168, 85, 247, 0.8); /* å¢åŠ éœ“è™¹å‘å…‰ */
  /* å¦‚æœä¸æƒ³è¦ "|" ç¬¦å·ï¼Œå¯ä»¥å°è¯•æŠŠå­—ä½“è®¾ä¸ºé€æ˜ï¼Œ
     ç„¶åç”¨ border-left æ¥åšä¸€ä¸ªå®å¿ƒæ–¹å—å…‰æ ‡ */
  /* border-left: 3px solid #a855f7; */
  /* height: 1em; */
}

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  /* ç§»åŠ¨ç«¯é€‚é… */
  @media (max-width: 640px) {
    .typewriter-container {
      font-size: 1.5rem;
    }
  }
</style>

<script define:vars={{ dynamicWords, speed, deleteSpeed, delay }}>
  const target = document.getElementById('dynamic-text');
  let wordIndex = 0;
  let charIndex = 0;
  let isDeleting = false;

  function type() {
    const currentWord = dynamicWords[wordIndex];
    
    if (isDeleting) {
      // åˆ é™¤é€»è¾‘
      target.textContent = currentWord.substring(0, charIndex - 1);
      charIndex--;
    } else {
      // æ‰“å­—é€»è¾‘
      target.textContent = currentWord.substring(0, charIndex + 1);
      charIndex++;
    }

    // ç¡®å®šä¸‹ä¸€å¸§çš„é€Ÿåº¦
    let typeSpeed = isDeleting ? deleteSpeed : speed;

    // å¦‚æœå•è¯æ‰“å®Œäº†
    if (!isDeleting && charIndex === currentWord.length) {
      typeSpeed = delay; // åœé¡¿ä¸€ä¸‹å†åˆ é™¤
      isDeleting = true;
    } 
    // å¦‚æœå•è¯åˆ å®Œäº†
    else if (isDeleting && charIndex === 0) {
      isDeleting = false;
      wordIndex = (wordIndex + 1) % dynamicWords.length; // åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¯
      typeSpeed = 500; // æ¢è¯å‰ç¨å¾®åœé¡¿
    }

    setTimeout(type, typeSpeed);
  }

  // å¯åŠ¨
  if (target) type();
</script>